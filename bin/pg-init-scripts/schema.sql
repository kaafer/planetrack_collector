CREATE TABLE plane
(
    id            integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    registration  VARCHAR(20),
    aircraft_code VARCHAR(20),
    icao_24bit    VARCHAR(20) UNIQUE
);

CREATE TABLE track
(
    id           integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    created_date timestamp default now(),
    latitude     float8,
    longitude    float8,
    altitude     integer,
    ground_speed integer,
    heading      integer,
    plane_id     integer,
    CONSTRAINT fk_plane foreign key (plane_id) REFERENCES plane (id)
);

CREATE
OR REPLACE FUNCTION trigger_set_timestamp()
    RETURNS TRIGGER AS $$
BEGIN
    NEW.created_date
= NOW();
RETURN NEW;
END;
$$
LANGUAGE plpgsql;

CREATE TRIGGER set_timestamp
    BEFORE INSERT
    ON track
    FOR EACH ROW
    EXECUTE PROCEDURE trigger_set_timestamp();